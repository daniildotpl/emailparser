Задача:
Сбор заявок клиента из определённой папки на ящике Яндекс почты и запись полученной информации в .csv файл, для дальнейшей обработки каким-то другим софтом.
Сбор происходит по расписанию. Собирать надо заявки за текущие сутки + последнюю заявку за предыдущие. 

Реализация:
Для подключения к ящику используется библиотека imap
Для парсинга и получения информации о заявке из письма - BeautifulSoup
Всё это на django. 
Скрипт запускается по времени с помощью планировщика задач. Представление вызывает класс наследующий TemplateView с миксином DoCsv.
Миксин DoCsv, который хранится в util.py собственно и приведён.